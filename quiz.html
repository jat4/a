<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Quiz Maker & Player</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ================= THEME ================= */
:root{
  --bg:#f4f6ff;
  --card:#ffffff;
  --text:#000000;
  --border:#cccccc;
  --primary:#5a6cff;
  --green:#1e8e3e;
  --blink-bg:#d4f8d4;
  --blink-text:#0b3d1e;
}
[data-theme="dark"]{
  --bg:#0f1220;
  --card:#181b2e;
  --text:#ffffff;
  --border:#333333;
  --primary:#8b94ff;
  --green:#3ddc84;
  --blink-bg:#1e6f4a;
  --blink-text:#ffffff;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
}
.container{
  max-width:950px;
  margin:auto;
  background:var(--card);
  padding:15px;
  position:relative;
}
h1,h2{text-align:center}

input,button{
  width:100%;
  padding:10px;
  margin:6px 0;
  font-size:16px;
  background:var(--card);
  color:var(--text);
  border:1px solid var(--border);
}
button{
  background:var(--primary);
  color:#fff;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
.hidden{display:none}
/* ===== THEME SETTINGS (BUTTON UI PATCH) ===== */
.settings-panel{
  border-radius:18px;
  box-shadow:0 10px 25px rgba(0,0,0,.35);
}

.settings-title{
  text-align:center;
  font-weight:bold;
  letter-spacing:1px;
  margin-bottom:12px;
}

.theme-btn{
  width:100%;
  padding:14px;
  margin:8px 0;
  border-radius:14px;
  border:1px solid var(--border);
  background:transparent;
  color:var(--text);
  font-size:16px;
}

.theme-btn.active{
  background:#6b6f8a;
  color:#fff;
  border-color:transparent;
}


/* ================= SETTINGS ================= */
.settings-btn{
  position:absolute;
  top:12px;
  right:15px;
  font-size:22px;
  cursor:pointer;
}
.settings-panel{
  position:absolute;
  top:45px;
  right:15px;
  background:var(--card);
  border:1px solid var(--border);
  padding:10px;
  border-radius:6px;
  width:160px;
}

/* ✅ FIXED ALIGNMENT */
.settings-panel label{
  display:flex;
  align-items:center;
  gap:8px;
  margin:6px 0;
  cursor:pointer;
}
.settings-panel input[type="radio"]{
  margin:0;
  transform:translateY(1px);
}

/* ================= HOME ================= */
.q-item{border-bottom:1px dashed var(--border);padding:6px 0}

/* ================= QUIZ ================= */
.timer{text-align:center;color:red;font-weight:bold}
.option{
  display:flex;
  gap:12px;
  border:1px solid var(--border);
  padding:12px;
  margin:6px 0;
  border-radius:6px;
}
.option-label{font-weight:bold;min-width:22px}
.option-text{flex:1}

/* Correct + Blink */
.correct{
  background:var(--blink-bg);
  border-color:var(--green);
  color:var(--blink-text);
  font-weight:600;
}
.blink{
  animation:blinkFix 0.7s ease-in-out 4;
}
@keyframes blinkFix{
  0%{background:var(--blink-bg);color:var(--blink-text)}
  50%{background:var(--card);color:var(--text)}
  100%{background:var(--blink-bg);color:var(--blink-text)}
}
[data-theme="dark"] .option.correct,
[data-theme="dark"] .option.blink{
  color:#ffffff;
}

.tick{
  color:var(--green);
  font-weight:bold;
  font-size:18px;
}

.correct-text,.complete-text{
  color:var(--green);
  font-weight:bold;
  text-align:center;
  margin-top:10px;
}

.btn-row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}

@media(min-width:768px){
  button{width:auto}
  .container{
    margin-top:20px;
    border-radius:10px;
    box-shadow:0 0 10px rgba(0,0,0,.15)
  }
}
</style>
</head>

<body>
<div class="container">

<!-- ================= HOME ================= -->
<div id="home">
<div class="settings-btn" onclick="toggleSettings()">⚙️</div>

<div id="settingsPanel" class="settings-panel hidden">
  <div class="settings-title">THEME SETTINGS</div>

  <!-- HIDDEN RADIOS (LOGIC KE LIYE) -->
  <input type="radio" name="theme" value="light" hidden>
  <input type="radio" name="theme" value="dark" hidden>
  <input type="radio" name="theme" value="auto" hidden>

  <!-- UI BUTTONS -->
  <button onclick="logout()">Logout</button>
  <button class="theme-btn" onclick="setThemeUI('light')">Light</button>
  <button class="theme-btn" onclick="setThemeUI('dark')">Dark</button>
  <button class="theme-btn" onclick="setThemeUI('auto')">Auto</button>
</div>
<h1>Quiz Maker</h1>

<input id="quizName" placeholder="Quiz Name">
<input id="timePerQuestion" type="number" value="10" placeholder="Time Per Question (sec)">
<input id="highlightTime" type="number" value="2" placeholder="Highlight Time Option (sec)">

<h3>Add / Edit Question</h3>
<input id="qText" placeholder="Question">
<input id="optA" placeholder="Option A">
<input id="optB" placeholder="Option B">
<input id="optC" placeholder="Option C">
<input id="optD" placeholder="Option D">
<input id="correct" placeholder="Correct Option (A/B/C/D)">
<button id="addQBtn">Add Question</button>

<h3>Questions</h3>
<div id="qList"></div>

<button id="saveQuizBtn">Save Quiz</button>
<button id="updateQuizBtn" class="hidden">Update Quiz</button>

<h3>Saved Quizzes</h3>
<div id="savedList"></div>
</div>

<!-- ================= QUIZ ================= -->
<div id="quiz" class="hidden">
<h2 id="quizTitle"></h2>
<p id="qNumber"></p>
<div class="timer">Time Left: <span id="time"></span>s</div>

<h3 id="question"></h3>

<div class="option" id="optABox"><span class="option-label">A.</span><span id="a" class="option-text"></span><span class="tick hidden">✔</span></div>
<div class="option" id="optBBox"><span class="option-label">B.</span><span id="b" class="option-text"></span><span class="tick hidden">✔</span></div>
<div class="option" id="optCBox"><span class="option-label">C.</span><span id="c" class="option-text"></span><span class="tick hidden">✔</span></div>
<div class="option" id="optDBox"><span class="option-label">D.</span><span id="d" class="option-text"></span><span class="tick hidden">✔</span></div>

<div id="correctText" class="correct-text hidden"></div>
<div id="completeText" class="complete-text hidden"></div>

<div class="btn-row">
<button onclick="prev()">Back</button>
<button id="pauseBtn" onclick="togglePause()">Pause</button>
<button onclick="quitQuiz()">Quit</button>
<button onclick="next()">Next</button>
</div>
</div>

</div>

<script>
/* ================= THEME ================= */
const mq=matchMedia('(prefers-color-scheme:dark)');
function applyTheme(t){
 if(t==='auto'){
  document.documentElement.removeAttribute('data-theme');
  if(mq.matches)document.documentElement.setAttribute('data-theme','dark');
 }else document.documentElement.setAttribute('data-theme',t);
 localStorage.setItem('quiz_theme',t);
}
mq.onchange=()=>localStorage.getItem('quiz_theme')==='auto'&&applyTheme('auto');
document.querySelectorAll('[name=theme]').forEach(r=>r.onchange=e=>applyTheme(e.target.value));
applyTheme(localStorage.getItem('quiz_theme')||'auto');
function toggleSettings(){settingsPanel.classList.toggle('hidden')}

/* ================= DATA ================= */
let quizzes=JSON.parse(localStorage.getItem('quizzes')||'[]');
let questions=[],editQuizIndex=null,editQuestionIndex=null;

/* ================= QUESTIONS ================= */
addQBtn.onclick=()=>{
 if(!qText.value||!optA.value||!optB.value||!optC.value||!optD.value||!['A','B','C','D'].includes(correct.value.toUpperCase()))
  return alert('Please fill all fields correctly');
 let q={q:qText.value,A:optA.value,B:optB.value,C:optC.value,D:optD.value,correct:correct.value.toUpperCase()};
 if(editQuestionIndex!=null){questions[editQuestionIndex]=q;editQuestionIndex=null;addQBtn.innerText='Add Question'}
 else questions.push(q);
 qText.value=optA.value=optB.value=optC.value=optD.value=correct.value='';
 renderQList();
};
function renderQList(){
 qList.innerHTML='';
 questions.forEach((q,i)=>{
  qList.innerHTML+=`${i+1}. ${q.q}
  <button onclick="editQuestion(${i})">Edit</button>
  <button onclick="deleteQuestion(${i})">Delete</button><br>`;
 });
}
function editQuestion(i){
 let q=questions[i];
 qText.value=q.q;optA.value=q.A;optB.value=q.B;optC.value=q.C;optD.value=q.D;correct.value=q.correct;
 editQuestionIndex=i;addQBtn.innerText='Update Question';
}
function deleteQuestion(i){questions.splice(i,1);renderQList()}

/* ================= SAVE ================= */
saveQuizBtn.onclick=()=>{
 if(!quizName.value||!questions.length)return alert('Quiz name and at least one question required');
 quizzes.push({name:quizName.value,time:+timePerQuestion.value,highlight:+highlightTime.value,questions:JSON.parse(JSON.stringify(questions))});
 localStorage.setItem('quizzes',JSON.stringify(quizzes));
 loadSaved();resetHome();
};
updateQuizBtn.onclick=()=>{
 quizzes[editQuizIndex]={name:quizName.value,time:+timePerQuestion.value,highlight:+highlightTime.value,questions:JSON.parse(JSON.stringify(questions))};
 localStorage.setItem('quizzes',JSON.stringify(quizzes));
 loadSaved();resetHome();
};
function loadSaved(){
 savedList.innerHTML='';
 quizzes.forEach((q,i)=>{
  savedList.innerHTML+=`${q.name}
  <button onclick="play(${i})">Play</button>
  <button onclick="editQuiz(${i})">Edit</button>
  <button onclick="delQuiz(${i})">Delete</button><br>`;
 });
}
loadSaved();
function editQuiz(i){
 let qz=quizzes[i];editQuizIndex=i;questions=JSON.parse(JSON.stringify(qz.questions));
 quizName.value=qz.name;timePerQuestion.value=qz.time;highlightTime.value=qz.highlight;
 saveQuizBtn.classList.add('hidden');updateQuizBtn.classList.remove('hidden');
 renderQList();
}
function delQuiz(i){quizzes.splice(i,1);localStorage.setItem('quizzes',JSON.stringify(quizzes));loadSaved();resetHome()}
function resetHome(){
 questions=[];editQuizIndex=null;editQuestionIndex=null;
 quizName.value='';timePerQuestion.value=10;highlightTime.value=2;
 addQBtn.innerText='Add Question';
 saveQuizBtn.classList.remove('hidden');updateQuizBtn.classList.add('hidden');
 renderQList();
}

/* ================= QUIZ PLAYER ================= */
let index=0,timer,timeLeft,paused=false,quizTime=10,highlightDelay=2;
function play(i){
 let qz=quizzes[i];
 questions=qz.questions;quizTime=qz.time;highlightDelay=qz.highlight;
 quizTitle.innerText=qz.name;
 home.classList.add('hidden');quiz.classList.remove('hidden');
 index=0;completeText.classList.add('hidden');loadQ();
}
function loadQ(){
 clearInterval(timer);
 document.querySelectorAll('.option').forEach(o=>o.classList.remove('correct','blink'));
 document.querySelectorAll('.tick').forEach(t=>t.classList.add('hidden'));
 correctText.classList.add('hidden');
 let q=questions[index];
 qNumber.innerText=`Question ${index+1}/${questions.length}`;
 question.innerText=q.q;
 a.innerText=q.A;b.innerText=q.B;c.innerText=q.C;d.innerText=q.D;
 timeLeft=quizTime;time.innerText=timeLeft;paused=false;pauseBtn.innerText='Pause';
 timer=setInterval(()=>{if(!paused&&!--timeLeft){time.innerText=0;showCorrect()}else time.innerText=timeLeft},1000);
}
function showCorrect(){
 clearInterval(timer);
 let c=questions[index].correct;
 let box=document.getElementById('opt'+c+'Box');
 box.classList.add('correct','blink');
 box.querySelector('.tick').classList.remove('hidden');
 correctText.innerText=`Correct Answer: ${c}. ${questions[index][c]}`;
 correctText.classList.remove('hidden');
 setTimeout(next,highlightDelay*1000);
}
function next(){
 if(index<questions.length-1){index++;loadQ()}
 else{completeText.innerText=`${questions.length} Questions Complete`;completeText.classList.remove('hidden')}
}
function prev(){if(index>0){index--;loadQ()}}
function togglePause(){paused=!paused;pauseBtn.innerText=paused?'Resume':'Pause'}
function quitQuiz(){clearInterval(timer);quiz.classList.add('hidden');home.classList.remove('hidden')}
function setThemeUI(theme){
    const radio = document.querySelector(
      'input[name="theme"][value="'+theme+'"]'
    );
    if(radio){
      radio.checked = true;
      radio.dispatchEvent(new Event('change'));
    }

    document.querySelectorAll('.theme-btn').forEach(btn=>{
      btn.classList.toggle(
        'active',
        btn.innerText.toLowerCase() === theme
      );
    });
  }

  window.addEventListener('load',()=>{
    const saved = localStorage.getItem('quiz_theme') || 'auto';
    document.querySelectorAll('.theme-btn').forEach(btn=>{
      btn.classList.toggle(
        'active',
        btn.innerText.toLowerCase() === saved
      );
    });
  });
<script src="firebase.js"></script>
<script src="quiz-firebase.js"></script>
</script>
</body>
</html>
